<body>
  <article>
    <br /><br />

    <div id="recherche">
      <h2>Recherche de trajet par planète</h2>
      <form action="post">
        <input [(ngModel)]="filtrePlaneteDep" name="pDepart" />
      </form>
    </div>
    <br />
    <div class="position">
      <table class="table">
        <thead>
          <tr>
            <th class="ddepart">Date départ</th>
            <th class="hdepart">Heure départ</th>
            <th class="darrivee">Date arrivée</th>
            <th class="harrivee">Heure arrivée</th>
            <th class="prix">Prix</th>
            <th class="depart">Planète départ</th>
            <th class="arrivee">Planète arrivée</th>
            <th class="vaisseau">Vaisseau</th>
            <ng-container *ngIf="!!login && role == 'admin'"
              ><th colspan="2" class="admin">Modification</th></ng-container
            >
            <ng-container *ngIf="!!login && role == 'client'"
              ><th colspan="2" class="client">Reserver</th></ng-container
            >
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let t of planeteFiltre">
            <td>{{ t.dateDepart }}</td>
            <td>{{ t.heureDepart }}</td>
            <td>{{ t.dateArrivee }}</td>
            <td>{{ t.heureArrivee }}</td>
            <td>{{ t.prix }}</td>
            <td>{{ t.depart!.nom }}</td>
            <td>{{ t.arrivee!.nom }}</td>
            <td>{{ t.vaisseau!.nom }}</td>

            <ng-container *ngIf="!!login && role == 'admin'">
              <td>
                <a
                  [routerLink]="['/trajet', 'edit', t.id]"
                  routerLinkActive="active"
                  class="btn btn-outline-primary"
                  >Editer
                </a>
              </td>
            </ng-container>

            <ng-container *ngIf="!!login && role == 'client' && resaPossible">
              <td>
                <a class="btn btn-outline-primary" (click)="affichSuiteResa(t)">
                  Reserver</a
                >
              </td>
            </ng-container>
            <br />

            <ng-container *ngIf="!!login && role == 'admin'">
              <td>
                <button
                  class="btn btn-outline-danger"
                  (click)="delete(t.id!)"
                  *ngIf="!trajetUtilise(t)"
                >
                  Supprimer
                </button>
                <p *ngIf="trajetUtilise(t)">Trajet encore utilisé !</p>
              </td>
            </ng-container>
          </tr>
        </tbody>
      </table>

      <ng-container *ngIf="!!login && role == 'admin'">
        <div class="new">
          <a
            [routerLink]="['/trajet', 'edit']"
            routerLinkActive="active"
            class="btn btn-outline-info"
            >Création trajet</a
          >
        </div>
      </ng-container>
    </div>
    <br />
    <ng-container *ngIf="!!login && role == 'client' && affichPassaActi">
      <table class="tableau">
        <tr>
          <td id="col1">
            <select class="form-control" [(ngModel)]="indexPassager">
              <option
                *ngFor="let pass of passagers; let i = index"
                [value]="i"
                value="test"
              >
                {{ pass.prenom }} {{ pass.nom }}
              </option>
            </select>
          </td>
          <td id="col2">
            <a
              routerLink="/trajet"
              routerLinkActive="active"
              class="btn btn-primary"
              (click)="ajouterPass()"
              >Ajouter passager</a
            >
          </td>
          <td id="col3"><p>Vos passagers :</p></td>
          <td id="col4">
            <select class="form-control" [(ngModel)]="passagersChoix">
              <option
                *ngFor="let pass of passagersChoix; let i = index"
                [value]="pass"
              >
                {{ pass.prenom }} {{ pass.nom }}
              </option>
            </select>
          </td>
        </tr>

        <tr>
          <td id="col1">
            <select class="form-control" [(ngModel)]="indexActivite">
              <option
                *ngFor="let actt of activitestris; let i = index"
                [value]="i"
              >
                {{ actt.nom }} {{ actt.prix }}
              </option>
            </select>
          </td>
          <td id="col2">
            <a
              routerLink="/trajet"
              routerLinkActive="active"
              class="btn btn-primary"
              (click)="ajouterActi()"
              >Ajouter activité</a
            >
          </td>
          <td id="col3"><p>Vos activités :</p></td>
          <td id="col4">
            <select class="form-control" [(ngModel)]="activitesChoix">
              <option
                *ngFor="let act of activitesChoix; let i = index"
                [value]="act"
              >
                {{ act.nom }} {{ act.prix }}
              </option>
            </select>
          </td>
        </tr>
      </table>
      <br />
      <div class="reservation">
        <a
          routerLink="/menu_client"
          routerLinkActive="active"
          class="btn btn-outline-primary"
          (click)="validerReservation()"
          >Valider réservation:</a
        >

        <a
          routerLink="/trajet"
          routerLinkActive="active"
          class="btn btn-primary"
          (click)="retour()"
          >Retour</a
        >
      </div>
      <br />
    </ng-container>
  </article>
</body>
